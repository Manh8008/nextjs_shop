(()=>{var e={};e.id=880,e.ids=[880],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6650:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>h,pages:()=>d,routeModule:()=>u,tree:()=>l}),s(1872),s(6402),s(5866);var a=s(3191),n=s(8716),r=s(7922),i=s.n(r),o=s(5231),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let l=["",{children:["(web)",{children:["checkout",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1872)),"E:\\fe_fw2\\duAn\\frontend\\src\\app\\(web)\\checkout\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6402)),"E:\\fe_fw2\\duAn\\frontend\\src\\app\\(web)\\layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["E:\\fe_fw2\\duAn\\frontend\\src\\app\\(web)\\checkout\\page.js"],h="/(web)/checkout/page",m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(web)/checkout/page",pathname:"/checkout",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},8638:(e,t,s)=>{Promise.resolve().then(s.bind(s,7919))},7919:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(326);s(434);var n=s(7577),r=s(5047),i=s(5842),o=s(8069),c=s(4100);let l=()=>{let e=(0,r.useRouter)(),[t,s]=(0,n.useState)(""),[l,d]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[u,p]=(0,n.useState)(""),[x,g]=(0,n.useState)(0),[_,j]=(0,n.useState)(""),f=(0,i.v9)(e=>e.cart.items),[v,y]=(0,n.useState)(null),N=(0,i.I0)();(0,n.useEffect)(()=>{(async()=>{try{let e=JSON.parse(localStorage.getItem("userInfo")).token,t=await fetch("http://localhost:5000/users/profile",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw Error("Lỗi xảy ra khi lấy th\xf4ng tin người d\xf9ng");let a=await t.json();y(a),d(a.username||""),s(a.phone||""),m(a.address||"")}catch(e){console.error("Fetch error:",e)}})()},[]);let b=e=>{j(e.target.value)};(0,n.useEffect)(()=>{(()=>{let e=0;f.forEach(t=>{e+=t.price*t.quantity}),g(e)})()},[f]);let w=()=>l?t?/(84|0[3|5|7|8|9])+([0-9]{8})\b/g.test(t)?h?null:"Lỗi! Vui l\xf2ng nhập Địa chỉ":"Lỗi! Số điện thoại kh\xf4ng hợp lệ":"Lỗi! Vui l\xf2ng nhập Số Điện Thoại":"Lỗi! Vui l\xf2ng nhập Họ T\xean",k=async s=>{if(s.preventDefault(),0===f.length){p("Bạn cần c\xf3 \xedt nhất một sản phẩm trong giỏ h\xe0ng!");return}let a=w();if(a){p(a);return}try{let s=await fetch("http://localhost:5000/orders/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:t,username:l,address:h,totalAmount:x,cart:f,paymentMethod:_})}),a=await s.json();if(s.ok){let t=a._id;if("0"===_){let e=await fetch("http://localhost:5000/payments/createPayment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:x+38e3,orderInfo:`${t}`,orderId:t})}),s=await e.json();e.ok?window.location.href=s.payUrl:p(s.error||"Lỗi khi tạo y\xeau cầu thanh to\xe1n MoMo")}else(0,o.ID)("Đặt h\xe0ng th\xe0nh c\xf4ng!","success"),N((0,c.LL)()),setTimeout(()=>{e.push("/")},1500)}else p(a.error||"Lỗi! C\xf3 lỗi xảy ra")}catch(e){p("Xin vui l\xf2ng nhập đầy đủ th\xf4ng tin!")}};return(0,a.jsxs)("div",{className:"main-container",children:[(0,a.jsxs)("div",{className:"register-form grid wide",children:[u&&a.jsx("p",{className:"alert alert-danger",children:u}),(0,a.jsxs)("form",{onSubmit:k,className:"form grid__row",id:"form-1",children:[(0,a.jsxs)("div",{className:"c-8",children:[a.jsx("h3",{className:"heading",children:"Th\xf4ng tin kh\xe1ch h\xe0ng"}),(0,a.jsxs)("div",{className:"grid__row",children:[a.jsx("div",{className:"c-6",children:(0,a.jsxs)("div",{className:"form-group col",children:[a.jsx("label",{htmlFor:"username",className:"form-label",children:"T\xean t\xe0i khoản:"}),a.jsx("input",{value:l,onChange:e=>d(e.target.value),id:"username",name:"username",type:"text",placeholder:"Họ t\xean...",className:"form-control"}),a.jsx("span",{className:"form-message"})]})}),a.jsx("div",{className:"c-6",children:(0,a.jsxs)("div",{className:"form-group col",children:[a.jsx("label",{htmlFor:"phone",className:"form-label",children:"Số điện thoại:"}),a.jsx("input",{value:t,onChange:e=>s(e.target.value),id:"phone",name:"phone",type:"text",placeholder:"Số điện thoại...",className:"form-control"}),a.jsx("span",{className:"form-message"})]})}),a.jsx("div",{className:"c-12",children:(0,a.jsxs)("div",{className:"form-group col",children:[a.jsx("label",{htmlFor:"address",className:"form-label",children:"Địa chỉ:"}),a.jsx("input",{value:h,onChange:e=>m(e.target.value),id:"address",name:"address",type:"text",placeholder:"Địa chỉ...",className:"form-control"}),a.jsx("span",{className:"form-message"})]})}),a.jsx("div",{className:"c-12",children:(0,a.jsxs)("div",{className:"checkout-payment",children:[a.jsx("h3",{className:"heading",children:"Phương thức thanh to\xe1n"}),(0,a.jsxs)("div",{className:"block-border",children:[a.jsx("p",{children:"Mọi giao dịch đều được bảo mật v\xe0 m\xe3 h\xf3a. Th\xf4ng tin thẻ t\xedn dụng sẽ kh\xf4ng bao giờ được lưu lại."}),(0,a.jsxs)("div",{className:"checkout-payment__options",children:[(0,a.jsxs)("label",{className:"ds__item",children:[a.jsx("input",{className:"ds__item__input",type:"radio",name:"payment_method",id:"payment_method_5",value:"0",checked:"0"===_,onChange:b}),a.jsx("span",{className:"ds__item__label",children:"Thanh to\xe1n bằng MoMo"})]}),(0,a.jsxs)("label",{className:"ds__item",children:[a.jsx("input",{className:"ds__item__input",type:"radio",name:"payment_method",id:"payment_method_3",value:"1",checked:"1"===_,onChange:b}),a.jsx("span",{className:"ds__item__label",children:"Thanh to\xe1n khi giao h\xe0ng"})]})]})]})]})})]})]}),(0,a.jsxs)("div",{className:"c-3",children:[a.jsx("div",{className:"cart-summary",children:a.jsx("div",{id:"box_product_total",children:(0,a.jsxs)("div",{className:"cart-summary__overview",children:[a.jsx("h3",{className:"heading",children:"T\xf3m tắt đơn h\xe0ng"}),(0,a.jsxs)("div",{className:"cart-summary__overview__item",children:[a.jsx("p",{children:"Tổng tiền h\xe0ng"}),a.jsx("p",{children:x.toLocaleString("vi-VN",{style:"currency",currency:"VND"})})]}),(0,a.jsxs)("div",{className:"cart-summary__overview__item",children:[a.jsx("p",{children:"Tạm t\xednh"}),a.jsx("p",{children:x.toLocaleString("vi-VN",{style:"currency",currency:"VND"})})]}),(0,a.jsxs)("div",{className:"cart-summary__overview__item",children:[a.jsx("p",{children:"Ph\xed vận chuyển"}),a.jsx("p",{children:"38.000đ"})]}),(0,a.jsxs)("div",{className:"cart-summary__overview__item",children:[a.jsx("p",{children:"Tiền thanh to\xe1n"}),a.jsx("p",{children:(x+38e3).toLocaleString("vi-VN",{style:"currency",currency:"VND"})})]}),a.jsx("hr",{style:{marginTop:20}})]})})}),a.jsx("div",{className:"col",children:a.jsx("button",{className:"form-submit",type:"submit",children:"Ho\xe0n th\xe0nh"})})]})]})]}),a.jsx("div",{className:"site-bottom"})]})}},1872:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>r,default:()=>o});var a=s(8570);let n=(0,a.createProxy)(String.raw`E:\fe_fw2\duAn\frontend\src\app\(web)\checkout\page.js`),{__esModule:r,$$typeof:i}=n;n.default;let o=(0,a.createProxy)(String.raw`E:\fe_fw2\duAn\frontend\src\app\(web)\checkout\page.js#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[819,758,901,328,915,944,459],()=>s(6650));module.exports=a})();