(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9311],{1304:function(e,a,s){Promise.resolve().then(s.bind(s,6019))},6463:function(e,a,s){"use strict";var n=s(1169);s.o(n,"usePathname")&&s.d(a,{usePathname:function(){return n.usePathname}}),s.o(n,"useRouter")&&s.d(a,{useRouter:function(){return n.useRouter}})},6019:function(e,a,s){"use strict";s.r(a),s.d(a,{validationSchema:function(){return c}});var n=s(7437),i=s(2265),r=s(9381),l=s(4245),t=s(6463);let c=l.Ry({name:l.Z_().required("T\xean sản phẩm l\xe0 bắt buộc"),description:l.Z_().required("Mi\xeau tả l\xe0 bắt buộc"),price:l.Rx().required("Gi\xe1 l\xe0 bắt buộc").positive("Gi\xe1 phải lớn hơn 0"),categorySlug:l.Z_().required("Danh mục l\xe0 bắt buộc"),quantity:l.Rx().required("Số lượng l\xe0 bắt buộc").positive("Số lượng phải lớn hơn 0").integer("Số lượng phải l\xe0 số nguy\xean"),image:l.Z_().required("Chọn ảnh sản phẩm l\xe0 bắt buộc ")});a.default=function(e){let{params:a}=e,s=(0,t.useRouter)(),[l,o]=(0,i.useState)(""),[u,h]=(0,i.useState)([]),[d,m]=(0,i.useState)(""),p=(0,r.TA)({initialValues:{name:"",description:"",price:"",isNew:!1,isOnSale:!1,image:null,categorySlug:"",quantity:""},validationSchema:c,onSubmit:async e=>{o("");try{let n=new FormData;for(let a in e)"image"===a&&null!==e[a]?n.append(a,e[a]):"image"!==a&&n.append(a,e[a]);let i=await fetch("http://localhost:5000/products/".concat(a.id),{method:"PUT",body:n});if(!i.ok)throw Error("Mạng kh\xf4ng ổn định");await i.json(),o("Sửa sản phẩm th\xe0nh c\xf4ng!"),setTimeout(()=>{s.push("/admin/products")},1500)}catch(e){o(e.message)}}}),g=(0,i.useCallback)(async()=>{try{let e=await fetch("http://localhost:5000/categories"),a=await e.json();h(a)}catch(e){console.error("Error fetching categories:",e)}},[]);(0,i.useEffect)(()=>{g(),(async()=>{try{let e=await fetch("http://localhost:5000/products/".concat(a.id,"/edit")),s=await e.json();p.setValues({name:s.name,description:s.description,price:s.price,isNew:s.isNew,isOnSale:s.isOnSale,categorySlug:s.categorySlug,quantity:s.quantity,image:s.image}),m(s.image)}catch(e){console.error("Error loading product:",e)}})()},[g,a.id]);let x=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map(e=>(0,n.jsxs)(i.Fragment,{children:[(0,n.jsxs)("option",{value:e.slug,children:["-".repeat(a)," ",e.name]}),e.subcategories&&x(e.subcategories,a+1)]},e._id))};return(0,n.jsx)("div",{className:"table-data",children:(0,n.jsxs)("div",{id:"check-out",children:[l&&(0,n.jsx)("p",{className:"alert alert-success",children:l}),(0,n.jsx)("div",{className:"container_form-checkout",children:(0,n.jsxs)("form",{onSubmit:p.handleSubmit,children:[(0,n.jsxs)("div",{className:"row",children:[(0,n.jsxs)("div",{className:"col",children:[(0,n.jsx)("h3",{className:"title",children:"Sửa sản phẩm"}),(0,n.jsxs)("div",{className:"inputBox",children:[(0,n.jsx)("span",{children:"T\xean sản phẩm:"}),(0,n.jsx)("input",{type:"text",placeholder:"Nhập t\xean sản phẩm...",name:"name",value:p.values.name,onChange:p.handleChange,onBlur:p.handleBlur}),p.touched.name&&p.errors.name?(0,n.jsxs)("div",{className:"error-msg",children:[(0,n.jsx)("i",{className:"fa-solid fa-circle-exclamation"})," ",p.errors.name]}):null]}),(0,n.jsxs)("div",{className:"inputBox",children:[(0,n.jsx)("span",{children:"Gi\xe1 :"}),(0,n.jsx)("input",{name:"price",type:"text",placeholder:"Nhập gi\xe1...",value:p.values.price,onChange:p.handleChange,onBlur:p.handleBlur}),p.touched.price&&p.errors.price?(0,n.jsxs)("div",{className:"error-msg",children:[(0,n.jsx)("i",{className:"fa-solid fa-circle-exclamation"})," ",p.errors.price]}):null]}),(0,n.jsxs)("div",{className:"inputBox",children:[(0,n.jsx)("span",{children:"Số lượng :"}),(0,n.jsx)("input",{type:"number",name:"quantity",placeholder:"Nhập số lượng...",value:p.values.quantity,onChange:p.handleChange,onBlur:p.handleBlur}),p.touched.quantity&&p.errors.quantity?(0,n.jsxs)("div",{className:"error-msg",children:[(0,n.jsx)("i",{className:"fa-solid fa-circle-exclamation"}),p.errors.quantity]}):null]})]}),(0,n.jsxs)("div",{className:"col",children:[(0,n.jsx)("h3",{className:"title",children:"-----"}),(0,n.jsxs)("div",{className:"inputBox",children:[(0,n.jsx)("span",{children:"Danh mục :"}),(0,n.jsxs)("select",{name:"categorySlug",value:p.values.categorySlug,onChange:p.handleChange,onBlur:p.handleBlur,children:[(0,n.jsx)("option",{value:"",children:"Chọn danh mục"}),x(u)]}),p.touched.categorySlug&&p.errors.categorySlug?(0,n.jsxs)("div",{className:"error-msg",children:[(0,n.jsx)("i",{className:"fa-solid fa-circle-exclamation"})," ",p.errors.categorySlug]}):null]}),(0,n.jsxs)("div",{className:"inputBox",children:[(0,n.jsx)("span",{children:"Mi\xeau tả :"}),(0,n.jsx)("textarea",{name:"description",cols:"68",rows:"5",placeholder:"Nhập mi\xeau tả...",value:p.values.description,onChange:p.handleChange,onBlur:p.handleBlur}),p.touched.description&&p.errors.description?(0,n.jsxs)("div",{className:"error-msg",children:[(0,n.jsx)("i",{className:"fa-solid fa-circle-exclamation"})," ",p.errors.description]}):null]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsxs)("div",{className:"inputBox",children:[(0,n.jsx)("input",{name:"image",type:"file",onChange:e=>{p.setFieldValue("image",e.currentTarget.files[0]),m(e.currentTarget.files[0].name)}}),p.touched.image&&p.errors.image?(0,n.jsxs)("div",{className:"error-msg",children:[(0,n.jsx)("i",{className:"fa-solid fa-circle-exclamation"})," ",p.errors.image]}):null]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:"H\xecnh ảnh :"}),d&&(0,n.jsx)("div",{className:"current-image",children:(0,n.jsx)("img",{src:"".concat("http://localhost:5000/images","/").concat(d),alt:"H\xecnh ảnh sản phẩm hiện tại",style:{width:100,height:150}})})]})]})]})]}),(0,n.jsx)("button",{type:"submit",className:"submit-btn",children:"Sửa"})]})})]})})}}},function(e){e.O(0,[4349,2971,7023,1744],function(){return e(e.s=1304)}),_N_E=e.O()}]);